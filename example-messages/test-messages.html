<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket Server Message Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .message-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .message-section h3 {
            margin-top: 0;
            color: #333;
        }
        .message-example {
            background: #f8f9fa;
            padding: 10px;
            border-left: 4px solid #007bff;
            margin: 10px 0;
        }
        .message-example pre {
            margin: 0;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .send-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .send-button:hover {
            background: #0056b3;
        }
        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .log {
            background: #f8f9fa;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        .log-sent {
            background: #e3f2fd;
            border-left: 3px solid #2196f3;
        }
        .log-received {
            background: #e8f5e8;
            border-left: 3px solid #4caf50;
        }
        .log-error {
            background: #ffebee;
            border-left: 3px solid #f44336;
        }
        .controls {
            margin-bottom: 20px;
        }
        .controls button {
            margin-right: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .connect-btn {
            background: #28a745;
            color: white;
        }
        .disconnect-btn {
            background: #dc3545;
            color: white;
        }
        .clear-btn {
            background: #6c757d;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Socket Server Message Tester</h1>
        
        <div class="controls">
            <button id="connectBtn" class="connect-btn">Connect</button>
            <button id="disconnectBtn" class="disconnect-btn" disabled>Disconnect</button>
            <button id="clearLogBtn" class="clear-btn">Clear Log</button>
        </div>
        
        <div id="status" class="status disconnected">
            Disconnected
        </div>
        
        <div id="log" class="log">
            <div class="log-entry">Ready to connect...</div>
        </div>
        
        <div class="message-section">
            <h3>1. Authentication</h3>
            <div class="message-example">
                <pre id="auth-message">{
  "action": "authenticate",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMTIzIiwidXNlcm5hbWUiOiJqb2huX2RvZSIsImVtYWlsIjoiam9obi5kb2VAZXhhbXBsZS5jb20iLCJleHAiOjE3MzY2MzUyMDB9.example_signature"
}</pre>
                <button class="send-button" onclick="sendMessage('auth-message')">Send Authentication</button>
            </div>
        </div>
        
        <div class="message-section">
            <h3>2. Join Channels</h3>
            <div class="message-example">
                <pre id="join-general">{
  "action": "join_channel",
  "channel": "general"
}</pre>
                <button class="send-button" onclick="sendMessage('join-general')">Join General Channel</button>
            </div>
            <div class="message-example">
                <pre id="join-orders">{
  "action": "join_channel",
  "channel": "orders"
}</pre>
                <button class="send-button" onclick="sendMessage('join-orders')">Join Orders Channel</button>
            </div>
        </div>
        
        <div class="message-section">
            <h3>3. Send Messages</h3>
            <div class="message-example">
                <pre id="send-text">{
  "action": "send_message",
  "channel": "general",
  "event": "message",
  "data": {
    "text": "Hello everyone!",
    "message_type": "text"
  }
}</pre>
                <button class="send-button" onclick="sendMessage('send-text')">Send Text Message</button>
            </div>
            <div class="message-example">
                <pre id="send-order">{
  "action": "send_message",
  "channel": "orders",
  "event": "order_status_update",
  "data": {
    "order_id": "ORD-2025-001",
    "status": "completed",
    "total_amount": 125.50,
    "customer_name": "John Doe",
    "timestamp": "2025-07-12T10:30:00Z"
  }
}</pre>
                <button class="send-button" onclick="sendMessage('send-order')">Send Order Update</button>
            </div>
        </div>
        
        <div class="message-section">
            <h3>4. Health Check</h3>
            <div class="message-example">
                <pre id="ping-message">{
  "action": "ping"
}</pre>
                <button class="send-button" onclick="sendMessage('ping-message')">Send Ping</button>
            </div>
        </div>
        
        <div class="message-section">
            <h3>5. Leave Channel</h3>
            <div class="message-example">
                <pre id="leave-general">{
  "action": "leave_channel",
  "channel": "general"
}</pre>
                <button class="send-button" onclick="sendMessage('leave-general')">Leave General Channel</button>
            </div>
        </div>
    </div>

    <script>
        let ws = null;
        let connected = false;
        
        const connectBtn = document.getElementById('connectBtn');
        const disconnectBtn = document.getElementById('disconnectBtn');
        const clearLogBtn = document.getElementById('clearLogBtn');
        const status = document.getElementById('status');
        const log = document.getElementById('log');
        
        function addLogEntry(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            entry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        function updateStatus(isConnected) {
            connected = isConnected;
            if (isConnected) {
                status.textContent = 'Connected';
                status.className = 'status connected';
                connectBtn.disabled = true;
                disconnectBtn.disabled = false;
            } else {
                status.textContent = 'Disconnected';
                status.className = 'status disconnected';
                connectBtn.disabled = false;
                disconnectBtn.disabled = true;
            }
            
            // Update send buttons
            const sendButtons = document.querySelectorAll('.send-button');
            sendButtons.forEach(btn => {
                btn.disabled = !isConnected;
            });
        }
        
        function connect() {
            const wsUrl = 'ws://localhost:8080/ws';
            addLogEntry(`Connecting to ${wsUrl}...`);
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                addLogEntry('‚úÖ Connected to socket server', 'received');
                updateStatus(true);
            };
            
            ws.onmessage = (event) => {
                const message = JSON.parse(event.data);
                addLogEntry(`üì® Received: ${JSON.stringify(message, null, 2)}`, 'received');
            };
            
            ws.onerror = (error) => {
                addLogEntry(`‚ùå WebSocket error: ${error}`, 'error');
            };
            
            ws.onclose = () => {
                addLogEntry('üîå Disconnected from socket server', 'error');
                updateStatus(false);
            };
        }
        
        function disconnect() {
            if (ws) {
                ws.close();
            }
        }
        
        function sendMessage(elementId) {
            if (!connected) {
                addLogEntry('‚ùå Not connected to server', 'error');
                return;
            }
            
            const messageElement = document.getElementById(elementId);
            const messageText = messageElement.textContent;
            
            try {
                const message = JSON.parse(messageText);
                addLogEntry(`üì§ Sending: ${JSON.stringify(message, null, 2)}`, 'sent');
                ws.send(JSON.stringify(message));
            } catch (error) {
                addLogEntry(`‚ùå Invalid JSON: ${error}`, 'error');
            }
        }
        
        function clearLog() {
            log.innerHTML = '<div class="log-entry">Log cleared...</div>';
        }
        
        // Event listeners
        connectBtn.addEventListener('click', connect);
        disconnectBtn.addEventListener('click', disconnect);
        clearLogBtn.addEventListener('click', clearLog);
        
        // Initialize
        updateStatus(false);
    </script>
</body>
</html>
